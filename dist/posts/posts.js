import{j as d,x as n,T as o}from"../__chunks__/lit-element.XkUWx5ik.js";import{o as h}from"../__chunks__/if-defined.JfW-uEqn.js";import{c as y}from"../__chunks__/createOptimizedPicture.lBh_4LJd.js";import{F as u}from"../__chunks__/fetch.service.MWvor5vW.js";import{i as P}from"../__chunks__/isSidekickLibraryActive.iN4ARc8o.js";const $=t=>t?n`<h3>${t}</h3>`:o,x=t=>t?t.length>200?n`<p>${t.slice(0,200)}...</p>`:n`<p>${t}</p>`:o,g=(t,e)=>e?n`<a href="${h(t)}" class="image">${e}</a>`:o,w=t=>{const{postUrl:e,headline:a,text:r,picture:p,buttontext:c}=t;return n`<article>${g(e,p)} ${$(a)} ${x(r)}<ul class="actions"><li><a href="${h(e)}" class="button">${c||"Goto Post"}</a></li></ul></article>`},T=t=>t.map(e=>w(e)),v=t=>{var a;return(a=Array.from(t.querySelectorAll("p")).find(r=>r.innerText.trim().length>0))==null?void 0:a.innerText};async function A(t){t.innerHTML="";const e=new DOMParser,r=(await u.fetchJson("/query-index.json")).data.filter(s=>s.path.startsWith("/posts")),f=(await Promise.all(r.map(s=>u.fetchText(`${s.path}.plain.html`,{cacheOptions:{cacheType:"runtime"}})))).map(s=>e.parseFromString(s,"text/html")).map((s,i)=>{var l,m;return{postUrl:P()?void 0:`${window.hlx.codeBasePath}${r[i].path}`,headline:((l=s.querySelector("h1"))==null?void 0:l.innerText)||((m=s.querySelector("h2"))==null?void 0:m.innerText),text:v(s),buttontext:r[i].buttontext,picture:y({src:r[i].image,alt:r[i].imagealt,width:323,height:199})}});t.style.removeProperty("display"),d(T(f),t)}export{A as default};
//# sourceMappingURL=posts.js.map
