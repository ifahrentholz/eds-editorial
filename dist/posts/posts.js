import{j as m,x as n,T as d}from"../__chunks__/lit-element.XkUWx5ik.js";import{c as P,m as $,P as f}from"../__chunks__/createOptimizedPicture.9tl1oSN6.js";import{F as h}from"../__chunks__/fetch.service.uw97pYhc.js";import{o as u}from"../__chunks__/if-defined.JfW-uEqn.js";import{i as g}from"../__chunks__/isSidekickLibraryActive.iN4ARc8o.js";const w=e=>e?n`<h3>${e}</h3>`:d,x=e=>e?e.length>200?n`<p>${e.slice(0,200)}...</p>`:n`<p>${e}</p>`:d,T=e=>{const{postUrl:a,headline:i,text:t,picture:s,buttontext:c}=e;return n`<article><a href="${u(a)}" class="image">${s}</a> ${w(i)} ${x(t)}<ul class="actions"><li><a href="${u(a)}" class="button">${c||"Goto Post"}</a></li></ul></article>`},v=e=>e.length===0?n`<article>${f.getPlaceHolder("no posts")}</article>`:e.map(a=>T(a)),H=e=>{var i;return(i=Array.from(e.querySelectorAll("p")).find(t=>t.innerText.trim().length>0))==null?void 0:i.innerText};async function A(e){e.innerHTML="";const a=new DOMParser;try{const t=(await h.fetchJson("/query-index.json")).data.filter(r=>r.path.includes("/posts")),y=(await Promise.all(t.map(r=>h.fetchText(`${r.path}.plain.html`,{cacheOptions:{cacheType:"runtime"}})))).map(r=>a.parseFromString(r,"text/html")).map((r,o)=>{var p,l;return{postUrl:g()?void 0:`${window.hlx.codeBasePath}${t[o].path}`,headline:((p=r.querySelector("h1"))==null?void 0:p.innerText)||((l=r.querySelector("h2"))==null?void 0:l.innerText),text:H(r),buttontext:t[o].buttontext,picture:P({src:t[o].image,alt:t[o].imagealt,width:323,height:199})}});e.style.removeProperty("display"),m(v(y),e)}catch{$.error("Error");const t=await f.getPlaceHolder("error"),s=document.createElement("div");m(n`<article style="width:100%"><p>${t}</p></article>`,s),e.innerHTML="",e.appendChild(s)}}export{A as default};
//# sourceMappingURL=posts.js.map
