{"version":3,"file":"banner.js","sources":["../../src/sidekickHelpers/extractSidekickLibraryId.ts","../../src/blocks/banner/banner.ts"],"sourcesContent":["import { isSidekickLibraryActive } from './isSidekickLibraryActive';\n\n/**\n * Represents the constructed Element.\n *\n * @interface ConstructedElement\n * @property {string} dataLibraryId - The data library id generated by the Sidekick Library Plugin.\n * @property {string} innerHTML - The innerHTML of a provided element.\n * @property {number} href - The href of a provided anchor element.\n */\nexport type ConstructedElement = {\n  dataLibraryId?: string;\n  innerHTML: string;\n  href?: string;\n};\n\n/**\n * Extracts the innerHTML, the href attribute (if defined) and\n * the data-library-id attribute (if the Sidekick Library Plugin is active) of a given HTML element.\n *\n * @param {HTMLElement | HTMLAnchorElement | null} element - The original HTMLElement or HTMLAnchorElement.\n * @returns {ConstructedElement} - A constructed element object.\n *\n * @example\n * const button = extractSidekickLibraryId(document.querySelector('a'));\n * <a\n *  href=\"${button.href}\"\n *  data-library-id=\"${ifDefined(button.id)}\"\n *  contenteditable=\"${ifDefined(button.id ? true : undefined)}\">\n *    ${button.text}\n * </a>\n *\n * @remarks\n * The data-library-id is generated by the Sidekick Library Plugin and is necessary to copy edited block content from the Sidekick Library.\n */\nexport const extractSidekickLibraryId = (element?: HTMLElement | HTMLAnchorElement | null): ConstructedElement => {\n  const constructedElement: ConstructedElement = { dataLibraryId: undefined, innerHTML: '', href: '' };\n  if (!element) return constructedElement;\n\n  constructedElement.innerHTML = element.innerHTML;\n  if (element instanceof HTMLAnchorElement && element.href !== '') {\n    constructedElement.href = element.href;\n  }\n\n  const sidekickLibraryId: string | null = element.getAttribute('data-library-id');\n  if (isSidekickLibraryActive() && sidekickLibraryId !== null) {\n    constructedElement.dataLibraryId = sidekickLibraryId;\n  }\n\n  return constructedElement;\n};\n","import { html, render } from 'lit';\nimport { unsafeHTML } from 'lit-html/directives/unsafe-html.js';\nimport { ifDefined } from 'lit-html/directives/if-defined.js';\nimport { ConstructedElement, extractSidekickLibraryId } from '../../sidekickHelpers/extractSidekickLibraryId';\nimport './banner.scss';\n\ninterface TemplateArgs {\n  headline: ConstructedElement;\n  subline: ConstructedElement;\n  picture?: HTMLPictureElement;\n  texts: ConstructedElement[];\n  buttons: ConstructedElement[];\n}\n\nconst template = (args: TemplateArgs) => {\n  const { headline, subline, texts, buttons, picture } = args;\n  return html`\n    <div id=\"banner\">\n      <div class=\"content\">\n        <header>\n          <h1\n            data-library-id=\"${ifDefined(headline.dataLibraryId)}\"\n            contenteditable=\"${ifDefined(headline.dataLibraryId ? true : undefined)}\"\n          >\n            ${headline.innerHTML}\n          </h1>\n          <p\n            data-library-id=\"${ifDefined(subline.dataLibraryId)}\"\n            contenteditable=\"${ifDefined(subline.dataLibraryId ? true : undefined)}\"\n          >\n            ${subline.innerHTML}\n          </p>\n        </header>\n        ${texts?.map(\n          (text) =>\n            html`<p\n              data-library-id=\"${ifDefined(text.dataLibraryId)}\"\n              contenteditable=\"${ifDefined(text.dataLibraryId ? true : undefined)}\"\n            >\n              ${text.innerHTML}\n            </p>`\n        )}\n        <ul class=\"actions\">\n          ${buttons?.map(\n            (button) =>\n              html`<li>\n                <a\n                  href=\"${button.href}\"\n                  class=\"button big\"\n                  data-library-id=\"${ifDefined(button.dataLibraryId)}\"\n                  contenteditable=\"${ifDefined(button.dataLibraryId ? true : undefined)}\"\n                  >${button.innerHTML}</a\n                >\n              </li>`\n          )}\n        </ul>\n      </div>\n      <span class=\"image object\"> ${picture ?? unsafeHTML(picture)} </span>\n    </div>\n  `;\n};\n\nexport default function (block: HTMLElement) {\n  const image = block.querySelector('img');\n  if (image) {\n    image.setAttribute('loading', 'eager');\n  }\n  const firstRow = block.querySelector('div');\n  const secondRow = block.children[1];\n  const headline = extractSidekickLibraryId(firstRow?.querySelector('h1'));\n  const subline = extractSidekickLibraryId(firstRow?.querySelector('h3'));\n  const texts = firstRow ? [...firstRow.querySelectorAll('p')].map((item) => extractSidekickLibraryId(item)) : [];\n  const buttons = secondRow ? [...secondRow.querySelectorAll('a')].map((item) => extractSidekickLibraryId(item)) : [];\n  const picture = firstRow?.querySelector('picture') || undefined;\n  const img = picture?.querySelector('img');\n  img?.setAttribute('loading', 'eager');\n\n  block.innerHTML = '';\n\n  block.style.removeProperty('display');\n  render(template({ headline, subline, texts, buttons, picture }), block);\n}\n"],"names":["extractSidekickLibraryId","element","constructedElement","sidekickLibraryId","isSidekickLibraryActive","template","args","headline","subline","texts","buttons","picture","html","ifDefined","text","button","unsafeHTML","banner","block","image","firstRow","secondRow","item","img","render"],"mappings":"0PAmCa,MAAAA,EAA4BC,GAAyE,CAChH,MAAMC,EAAyC,CAAE,cAAe,OAAW,UAAW,GAAI,KAAM,IAChG,GAAI,CAACD,EAAgB,OAAAC,EAErBA,EAAmB,UAAYD,EAAQ,UACnCA,aAAmB,mBAAqBA,EAAQ,OAAS,KAC3DC,EAAmB,KAAOD,EAAQ,MAG9B,MAAAE,EAAmCF,EAAQ,aAAa,iBAAiB,EAC3E,OAAAG,EAAA,GAA6BD,IAAsB,OACrDD,EAAmB,cAAgBC,GAG9BD,CACT,ECpCMG,EAAYC,GAAuB,CACvC,KAAM,CAAE,SAAAC,EAAU,QAAAC,EAAS,MAAAC,EAAO,QAAAC,EAAS,QAAAC,CAAY,EAAAL,EAChD,OAAAM,uEAKsBC,EAAUN,EAAS,aAAa,CAAC,sBACjCM,EAAUN,EAAS,cAAgB,GAAO,MAAS,CAAC,KAErEA,EAAS,SAAS,4BAGDM,EAAUL,EAAQ,aAAa,CAAC,sBAChCK,EAAUL,EAAQ,cAAgB,GAAO,MAAS,CAAC,KAEpEA,EAAQ,SAAS,gBAGrBC,GAAA,YAAAA,EAAO,IACNK,GACCF,wBACqBC,EAAUC,EAAK,aAAa,CAAC,sBAC7BD,EAAUC,EAAK,cAAgB,GAAO,MAAS,CAAC,KAEjEA,EAAK,SAAS,OAErB,uBAEGJ,GAAA,YAAAA,EAAS,IACRK,GACCH,iBAEYG,EAAO,IAAI,yCAEAF,EAAUE,EAAO,aAAa,CAAC,sBAC/BF,EAAUE,EAAO,cAAgB,GAAO,MAAS,CAAC,KAClEA,EAAO,SAAS,YAG1B,yCAGyBJ,GAAWK,EAAWL,CAAO,CAAC,eAGlE,EAEA,SAAAM,EAAyBC,EAAoB,CACrC,MAAAC,EAAQD,EAAM,cAAc,KAAK,EACnCC,GACIA,EAAA,aAAa,UAAW,OAAO,EAEjC,MAAAC,EAAWF,EAAM,cAAc,KAAK,EACpCG,EAAYH,EAAM,SAAS,CAAC,EAC5BX,EAAWP,EAAyBoB,GAAA,YAAAA,EAAU,cAAc,KAAK,EACjEZ,EAAUR,EAAyBoB,GAAA,YAAAA,EAAU,cAAc,KAAK,EAChEX,EAAQW,EAAW,CAAC,GAAGA,EAAS,iBAAiB,GAAG,CAAC,EAAE,IAAKE,GAAStB,EAAyBsB,CAAI,CAAC,EAAI,CAAA,EACvGZ,EAAUW,EAAY,CAAC,GAAGA,EAAU,iBAAiB,GAAG,CAAC,EAAE,IAAKC,GAAStB,EAAyBsB,CAAI,CAAC,EAAI,CAAA,EAC3GX,GAAUS,GAAA,YAAAA,EAAU,cAAc,aAAc,OAChDG,EAAMZ,GAAA,YAAAA,EAAS,cAAc,OAC9BY,GAAA,MAAAA,EAAA,aAAa,UAAW,SAE7BL,EAAM,UAAY,GAEZA,EAAA,MAAM,eAAe,SAAS,EAC7BM,EAAAnB,EAAS,CAAE,SAAAE,EAAU,QAAAC,EAAS,MAAAC,EAAO,QAAAC,EAAS,QAAAC,CAAA,CAAS,EAAGO,CAAK,CACxE"}