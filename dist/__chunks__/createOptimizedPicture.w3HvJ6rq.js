import{i as p}from"./extractSidekickLibraryId.ii0iU8xy.js";class w{constructor(){this.runtimeCache=new Map}get(e){return this.runtimeCache.get(e)}set(e,t){this.runtimeCache.set(e,t)}has(e){return this.runtimeCache.has(e)}delete(e){this.runtimeCache.delete(e)}}class f{constructor(){this.requestPipeline=new Map,this.runtimeCache=new w}fetchJson(e,t={}){return this.fetchData(e,t,this.getResponseJSON)}fetchText(e,t={}){return this.fetchData(e,t,this.getResponseText)}async fetchData(e,t,i){const{cacheOptions:u}=t,d=this.getCachedData(e,u);if(d!==null)return d;const c=this.requestPipeline.get(e);if(c!==void 0)return i(await c);const m=fetch(e,t.fetchOptions);this.requestPipeline.set(e,m);const o=await m;this.requestPipeline.delete(e);const n=await i(o);return this.setCachedData(e,n,u),n}async getResponseJSON(e){return await e.clone().json()}async getResponseText(e){return await e.clone().text()}getCachedData(e,t){return(t==null?void 0:t.cacheType)==="runtime"?this.runtimeCache.get(e)??null:null}setCachedData(e,t,i){(i==null?void 0:i.cacheType)==="runtime"&&this.runtimeCache.set(e,t)}}const A=new f;function g(){if(!p)return window.location.href;const{location:a}=window.parent,e=new URLSearchParams(a.search);return`${a.origin}${e.get("path")}`}function $(){return p?window.parent.location:window.location}function b(a){const{src:e,alt:t,eager:i=!1,width:u,height:d,breakpoints:c=[{media:"(min-width: 600px)",width:200},{width:750}]}=a,m=new URL(e,g()),o=document.createElement("picture"),{pathname:n}=m,l=n.substring(n.lastIndexOf(".")+1);return c.forEach(r=>{const h=document.createElement("source");r.media&&h.setAttribute("media",r.media),h.setAttribute("type","image/webp"),h.setAttribute("srcset",`${n}?width=${r.width}&format=webply&optimize=medium`),o.appendChild(h)}),c.forEach((r,h)=>{if(h<c.length-1){const s=document.createElement("source");r.media&&s.setAttribute("media",r.media),s.setAttribute("srcset",`${n}?width=${r.width}&format=${l}&optimize=medium`),o.appendChild(s)}else{const s=document.createElement("img");s.setAttribute("loading",i?"eager":"lazy"),s.setAttribute("alt",t),s.setAttribute("width",u.toString()),s.setAttribute("height",d.toString()),o.appendChild(s),s.setAttribute("src",`${n}?width=${r.width}&format=${l}&optimize=medium`)}}),o}export{A as F,b as c,$ as g};
//# sourceMappingURL=createOptimizedPicture.w3HvJ6rq.js.map
