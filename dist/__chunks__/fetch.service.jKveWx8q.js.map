{"version":3,"file":"fetch.service.jKveWx8q.js","sources":["../../src/services/fetch.service.ts"],"sourcesContent":["class FetchService {\n  private responseMap = new Map<string, Promise<Response>>();\n\n  private async fetchData(endpoint: string, init?: RequestInit): Promise<Response> {\n    const url = this.getUrl(endpoint);\n\n    if (this.responseMap.has(url)) return this.responseMap.get(url)!;\n\n    const fetchPromise = fetch(url, init);\n\n    this.responseMap.set(url, fetchPromise);\n\n    const response = await fetchPromise;\n\n    if (response.ok) return response;\n\n    //TODO: Use DebugService in future\n    console.error(response.statusText);\n    this.responseMap.delete(url);\n    return response;\n  }\n\n  public async fetchJson<T>(endpoint: string, init?: RequestInit): Promise<T> {\n    const response = await this.fetchData(endpoint, init);\n    return await response.clone().json();\n  }\n\n  public async fetchText(endpoint: string, init?: RequestInit): Promise<string> {\n    const response = await this.fetchData(endpoint, init);\n    return response.clone().text();\n  }\n\n  private getUrl(endpoint: string) {\n    const decoratedEndpoint = endpoint.startsWith('/') ? endpoint : `/${endpoint}`;\n    return `${window.hlx.codeBasePath}${decoratedEndpoint}`;\n  }\n}\n\nexport default new FetchService();\n"],"names":["FetchService","endpoint","init","url","fetchPromise","response","decoratedEndpoint","FetchService$1"],"mappings":"AAAA,MAAMA,CAAa,CAAnB,aAAA,CACU,KAAA,gBAAkB,GAA+B,CAEzD,MAAc,UAAUC,EAAkBC,EAAuC,CACzE,MAAAC,EAAM,KAAK,OAAOF,CAAQ,EAE5B,GAAA,KAAK,YAAY,IAAIE,CAAG,EAAU,OAAA,KAAK,YAAY,IAAIA,CAAG,EAExD,MAAAC,EAAe,MAAMD,EAAKD,CAAI,EAE/B,KAAA,YAAY,IAAIC,EAAKC,CAAY,EAEtC,MAAMC,EAAW,MAAMD,EAEvB,OAAIC,EAAS,KAGL,QAAA,MAAMA,EAAS,UAAU,EAC5B,KAAA,YAAY,OAAOF,CAAG,GACpBE,CACT,CAEA,MAAa,UAAaJ,EAAkBC,EAAgC,CAE1E,OAAO,MADU,MAAM,KAAK,UAAUD,EAAUC,CAAI,GAC9B,MAAM,EAAE,KAAK,CACrC,CAEA,MAAa,UAAUD,EAAkBC,EAAqC,CAErE,OADU,MAAM,KAAK,UAAUD,EAAUC,CAAI,GACpC,QAAQ,MAC1B,CAEQ,OAAOD,EAAkB,CAC/B,MAAMK,EAAoBL,EAAS,WAAW,GAAG,EAAIA,EAAW,IAAIA,CAAQ,GAC5E,MAAO,GAAG,OAAO,IAAI,YAAY,GAAGK,CAAiB,EACvD,CACF,CAEA,MAAeC,EAAA,IAAIP"}