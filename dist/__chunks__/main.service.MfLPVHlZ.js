import{t as w}from"./toClassName.DLENMWzL.js";import{_ as f}from"./preload-helper.D7itGvJr.js";import{i as m}from"./isSidekickLibraryActive.U-fJCMMj.js";class P{readBlockConfig(e){const t={};return e.querySelectorAll(":scope > div").forEach(s=>{if(s.children){const o=[...s.children];if(o[1]){const a=o[1],h=w(o[0].textContent??"");let c="";if(a.querySelector("a")){const i=[...a.querySelectorAll("a")];i.length===1?c=i[0].href:c=i.map(d=>d.href)}else if(a.querySelector("img")){const i=[...a.querySelectorAll("img")];i.length===1?c=i[0].src:c=i.map(d=>d.src)}else if(a.querySelector("p")){const i=[...a.querySelectorAll("p")];i.length===1?c=i[0].textContent:c=i.map(d=>d.textContent)}else c=s.children[1].textContent;t[h]=c}}}),t}decorateBlocks(e){e.querySelectorAll("div.section > div > div").forEach(this.decorateBlock)}decorateBlock(e){const t=e.classList[0];if(t){e.classList.add("block"),e.dataset.blockName=t;const s=e.parentElement;s==null||s.classList.add(`${t}-wrapper`);const o=e.closest(".section");o&&o.classList.add(`${t}-container`)}}}const y=(n,e)=>{e.split(",").forEach(t=>{n.classList.add(w(t.trim()))})};function u(n,e=document){const t=n&&n.includes(":")?"property":"name",o=[...e.head.querySelectorAll(`meta[${t}="${n}"]`)].map(a=>a.content).join(", ");return o.length?o:""}const p={mainTsPath:"src/main.ts",mainScssPath:"src/styles/sass/main.scss",iconsDirPath:"./public/icons",iconsTypesPath:"./src/icons.types.ts",fontsScssPath:"src/styles/sass/fonts.scss",lazyStylesScssPath:"src/styles/sass/lazy-styles.scss",sidekickLibraryStylesScssPath:"src/styles/sass/sidekick-library-styles.scss"};function S(){return m()?window.parent.location:window.location}const r=class r{};r.unloaded="unloaded",r.loading="loading",r.loaded="loaded",r.error="error";let l=r;class L{constructor(e,t){this.sectionService=e,this.blockService=t,this.lcpBlocks=["banner"],this.init=async()=>{this.setup(),await this.loadEager(),await this.loadLazy()},this.loadEager=async()=>{document.documentElement.lang="en",this.decorateTemplateAndTheme();const s=document.querySelector("main");if(s){s.setAttribute("id","main"),this.addSidebarContainer(s),this.sectionService.init(s),this.addInnerContainer(s),this.blockService.decorateBlocks(s),setTimeout(()=>{document.body.classList.add("show")},100),await this.waitForLCP();try{(window.innerWidth>=900||sessionStorage.getItem("fonts-loaded"))&&await this.loadFonts()}catch{}}},this.loadLazy=async()=>{const{lazyStylesScssPath:s,sidekickLibraryStylesScssPath:o,fontsScssPath:a}=p;try{s&&await this.loadCSS(`${window.hlx.codeBasePath}/dist/lazyStyles/lazyStyles.css`),o&&m()&&await this.loadCSS(`${window.hlx.codeBasePath}/dist/sidekickLibraryStyles/sidekickLibraryStyles.css`),a&&await this.loadFonts(),await this.loadBlocks()}catch(h){console.error("Load lazy error: ",h)}},this.loadBlocks=async()=>{const o=[...document.querySelectorAll(".section")].map(a=>this.loadBlock(a));await Promise.all(o)}}setup(){window.hlx=window.hlx||{},window.hlx.RUM_MASK_URL="full",window.hlx.codeBasePath="",window.hlx.lighthouse=new URLSearchParams(S().search).get("lighthouse")==="on";const e=document.querySelector('script[src$="/scripts/scripts.js"]');if(e)try{[window.hlx.codeBasePath]=new URL(e.src).pathname.split("/scripts/scripts.js")}catch(t){console.log(t)}}addSidebarContainer(e){if(m())return;const t=document.createElement("sidebar-component");t.setAttribute("id","sidebar"),window.innerWidth<=1280?t.classList.remove("active"):t.classList.add("active"),window.innerWidth<=1280?t.classList.remove("active"):t.classList.add("active"),e.after(t)}addInnerContainer(e){const t=e.innerHTML;e.innerHTML=`<div class="inner">${m()?"":'<header-component id="header"></header-component>'}${t}</div>`}decorateTemplateAndTheme(){const e=u("template");e&&y(document.body,e);const t=u("theme");t&&y(document.body,t)}collectBlocks(e){const t=[];return e.querySelectorAll("[data-block-name]").forEach(o=>{t.push({name:o.dataset.blockName,element:o})}),t}async loadBlockModules(e){if((e.element.dataset.blockStatus??l.unloaded)===l.unloaded){e.element.dataset.blockStatus=l.loading;try{const s=await f(()=>import(`${window.hlx.codeBasePath}/dist/${e.name}/${e.name}.js`),__vite__mapDeps([]));s.default&&await s.default(e.element),e.element.dataset.blockStatus=l.loaded}catch(s){e.element.dataset.blockStatus=l.error,console.error("An error occurred during module import:",s)}}}async loadBlockStyles(e){try{await this.loadCSS(`${window.hlx.codeBasePath}/dist/${e.name}/${e.name}.css`)}catch{console.error(`problem with block '${e.name}' loading styles`)}}showSection(e){e.style.removeProperty("display")}async loadFonts(){await this.loadCSS(`${window.hlx.codeBasePath}/dist/fonts/fonts.css`);try{S().hostname.includes("localhost")||sessionStorage.setItem("fonts-loaded","true")}catch{}}async loadCSS(e){return new Promise((t,s)=>{if(document.querySelector(`head > link[href="${e}"]`))t(!0);else{const o=document.createElement("link");o.rel="stylesheet",o.href=e,o.onload=t,o.onerror=s,document.head.append(o)}})}async waitForLCP(){const e=document.querySelector(".section");if(e){const o=this.collectBlocks(e).map(async a=>{this.lcpBlocks.includes(a.name)&&await Promise.all([this.loadBlockModules(a),this.loadBlockStyles(a)])});await Promise.all(o),this.showSection(e)}document.body.style.display=null;const t=document.querySelector("main img");await new Promise(s=>{t&&!t.complete?(t.setAttribute("loading","eager"),t.setAttribute("fetchpriority","high"),t.addEventListener("load",()=>s()),t.addEventListener("error",()=>s())):s()})}async loadBlock(e){const t=this.collectBlocks(e);if(!t.length){this.showSection(e);return}for(const s of t)Promise.all([this.loadBlockModules(s),this.loadBlockStyles(s)]);this.showSection(e)}}export{P as B,L as M};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
//# sourceMappingURL=main.service.MfLPVHlZ.js.map
